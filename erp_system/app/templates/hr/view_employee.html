{% extends "base.html" %}

{% block title %}View Employee - HR Dashboard{% endblock %}

{% block content %}
<h2 class="mt-4">View Employee Details</h2>
<div id="employeeDetails">
    <!-- Employee details will be injected here via JavaScript -->
</div>
<script>
    async function fetchEmployeeDetails() {
        const emp_id = "{{ emp_id }}";
        const token = localStorage.getItem('token');
        try {
            const response = await fetch(`/hr/get_employee/${emp_id}`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            });
            const data = await response.json();
            if (response.status === 200) {
                const emp = data.employee;
                const detailsDiv = document.getElementById('employeeDetails');
                detailsDiv.innerHTML = `
                    <p><strong>Employee ID:</strong> ${emp.emp_id}</p>
                    <p><strong>Name:</strong> ${emp.name}</p>
                    <p><strong>Position:</strong> ${emp.position}</p>
                    <p><strong>Department:</strong> ${emp.department}</p>
                    <p><strong>Email:</strong> ${emp.email}</p>
                    <p><strong>Phone:</strong> ${emp.phone}</p>
                `;
            } else {
                alert(`Error: ${data.error}`);
            }
        } catch (error) {
            console.error('Error fetching employee details:', error);
            alert('An error occurred while fetching employee details.');
        }
    }

    // Fetch employee details on page load
    fetchEmployeeDetails();
</script>
{% endblock %}
