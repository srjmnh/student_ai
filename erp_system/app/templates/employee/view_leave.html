{% extends "base.html" %}

{% block title %}View Leave Request - Employee Dashboard{% endblock %}

{% block content %}
<h2 class="mt-4">View Leave Request</h2>
<div id="leaveDetails">
    <!-- Leave details will be injected here via JavaScript -->
</div>
<script>
    async function fetchLeaveDetails() {
        const leave_id = "{{ leave_id }}";
        const token = localStorage.getItem('token');
        try {
            const response = await fetch(`/employee/get_leave/${leave_id}`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            });
            const data = await response.json();
            if (response.status === 200) {
                const leave = data.leave;
                const detailsDiv = document.getElementById('leaveDetails');
                detailsDiv.innerHTML = `
                    <p><strong>Leave ID:</strong> ${leave.leave_id}</p>
                    <p><strong>Start Date:</strong> ${leave.start_date}</p>
                    <p><strong>End Date:</strong> ${leave.end_date}</p>
                    <p><strong>Reason:</strong> ${leave.reason}</p>
                    <p><strong>Status:</strong> ${leave.status}</p>
                `;
            } else {
                alert(`Error: ${data.error}`);
            }
        } catch (error) {
            console.error('Error fetching leave details:', error);
            alert('An error occurred while fetching leave details.');
        }
    }

    // Fetch leave details on page load
    fetchLeaveDetails();
</script>
{% endblock %}
